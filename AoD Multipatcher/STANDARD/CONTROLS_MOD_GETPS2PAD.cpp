#include "stdafx.h"
#include "MISC/Misc_Functions.h"


bool Detect_GETPS2PAD_status()						// Restituisce vero se i controlli di mouse e gamepad sono modificati, falso se originali
{
	//////////////////		SYS_DI::GetPS2PAD		Stringhe originali
	string orig_traod_p4_52("\xFF\xB7\xC0\0\0\0\xFF\x35\x88\xCA\x71\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x84\xCA\x71\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x84\xCA\x71\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x80\xCA\x71\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p4_49("\xFF\xB7\xC0\0\0\0\xFF\x35\x48\xBA\x71\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x44\xBA\x71\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x44\xBA\x71\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x40\xBA\x71\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p4_42("\xFF\xB7\xC0\0\0\0\xFF\x35\x88\x37\x6F\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x84\x37\x6F\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x84\x37\x6F\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x80\x37\x6F\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p4_39("\xFF\xB7\xC0\0\0\0\xFF\x35\x88\x97\x6E\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x84\x97\x6E\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x84\x97\x6E\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x80\x97\x6E\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_52("\xD9\x1D\x44\xBA\x70\0\xFF\xB7\xC0\0\0\0\xFF\x35\x48\xBA\x70\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x44\xBA\x70\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\x40\xBA\x70\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_49("\xD9\x1D\x04\xBA\x70\0\xFF\xB7\xC0\0\0\0\xFF\x35\x08\xBA\x70\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x04\xBA\x70\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\0\xBA\x70\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_42("\xD9\x1D\x44\x37\x6E\0\xFF\xB7\xC0\0\0\0\xFF\x35\x48\x37\x6E\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x44\x37\x6E\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\x40\x37\x6E\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_39("\xD9\x1D\x04\x97\x6D\0\xFF\xB7\xC0\0\0\0\xFF\x35\x08\x97\x6D\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x04\x97\x6D\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\0\x97\x6D\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_52("\x8B\x95\xC0\0\0\0\xA1\x90\x22\x6C\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\0\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\x94\x22\x6C\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\x98\x22\x6C\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	string orig_traod_49("\x8B\x95\xC0\0\0\0\xA1\xD0\x13\x6C\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\x00\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\xD4\x13\x6C\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\xD8\x13\x6C\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	string orig_traod_42("\x8B\x95\xC0\0\0\0\xA1\x60\x4A\x6A\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\x00\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\x64\x4A\x6A\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\x68\x4A\x6A\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	string orig_traod_39("\x8B\x95\xC0\0\0\0\xA1\x90\xE1\x68\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\0\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\x94\xE1\x68\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\x98\xE1\x68\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	
	size_t Position;
	if ((Position = EXEorig.find(orig_traod_p4_52)) != std::string::npos || (Position = EXEorig.find(orig_traod_p4_49)) != std::string::npos ||
		(Position = EXEorig.find(orig_traod_p4_42)) != std::string::npos || (Position = EXEorig.find(orig_traod_p4_39)) != std::string::npos ||
		(Position = EXEorig.find(orig_traod_p3_52)) != std::string::npos || (Position = EXEorig.find(orig_traod_p3_49)) != std::string::npos ||
		(Position = EXEorig.find(orig_traod_p3_42)) != std::string::npos || (Position = EXEorig.find(orig_traod_p3_39)) != std::string::npos ||
		(Position = EXEorig.find(orig_traod_52)) != std::string::npos || (Position = EXEorig.find(orig_traod_49)) != std::string::npos ||
		(Position = EXEorig.find(orig_traod_42)) != std::string::npos || (Position = EXEorig.find(orig_traod_39)) != std::string::npos)
		return false;
	return true;			// Se non trova alcuna stringa originale significa che il file è modificato
}


void Change_GETPS2PAD_status()						// Reindirizza correttamente i dati di input di mouse e gamepad
{
	//////////////////		SYS_DI::GetPS2PAD		Stringhe originali
	string orig_traod_p4_52("\xFF\xB7\xC0\0\0\0\xFF\x35\x88\xCA\x71\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x84\xCA\x71\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x84\xCA\x71\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x80\xCA\x71\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p4_49("\xFF\xB7\xC0\0\0\0\xFF\x35\x48\xBA\x71\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x44\xBA\x71\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x44\xBA\x71\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x40\xBA\x71\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p4_42("\xFF\xB7\xC0\0\0\0\xFF\x35\x88\x37\x6F\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x84\x37\x6F\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x84\x37\x6F\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x80\x37\x6F\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p4_39("\xFF\xB7\xC0\0\0\0\xFF\x35\x88\x97\x6E\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xD9\x1D\x84\x97\x6E\0\xE8\x2F\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x16\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x84\x97\x6E\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\xF9\xFB\xFF\xFF\x83\xC4\x30\xA2\x80\x97\x6E\0\xB0\0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_52("\xD9\x1D\x44\xBA\x70\0\xFF\xB7\xC0\0\0\0\xFF\x35\x48\xBA\x70\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x44\xBA\x70\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\x40\xBA\x70\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_49("\xD9\x1D\x04\xBA\x70\0\xFF\xB7\xC0\0\0\0\xFF\x35\x08\xBA\x70\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x04\xBA\x70\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\0\xBA\x70\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_42("\xD9\x1D\x44\x37\x6E\0\xFF\xB7\xC0\0\0\0\xFF\x35\x48\x37\x6E\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x44\x37\x6E\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\x40\x37\x6E\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_p3_39("\xD9\x1D\x04\x97\x6D\0\xFF\xB7\xC0\0\0\0\xFF\x35\x08\x97\x6D\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x39\xFC\xFF\xFF\x88\x45\x15\xFF\xB7\xC4\0\0\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x20\xFC\xFF\xFF\x88\x45\x17\xFF\xB7\xC4\0\0\0\xFF\x35\x04\x97\x6D\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x03\xFC\xFF\xFF\x83\xC4\x30\xA2\0\x97\x6D\0\x32\xC0\x88\x45\x14\x88\x45\x16\x8B\x45\0", 105);
	string orig_traod_52("\x8B\x95\xC0\0\0\0\xA1\x90\x22\x6C\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\0\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\x94\x22\x6C\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\x98\x22\x6C\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	string orig_traod_49("\x8B\x95\xC0\0\0\0\xA1\xD0\x13\x6C\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\x00\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\xD4\x13\x6C\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\xD8\x13\x6C\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	string orig_traod_42("\x8B\x95\xC0\0\0\0\xA1\x60\x4A\x6A\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\x00\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\x64\x4A\x6A\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\x68\x4A\x6A\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);
	string orig_traod_39("\x8B\x95\xC0\0\0\0\xA1\x90\xE1\x68\0\x8B\x8D\x80\0\0\0\x52\x8B\x55\x60\x50\x51\x52\xE8\x02\x01\0\0\x88\x43\x15\x8B\x85\xC4\0\0\0\x8B\x8D\x84\0\0\0\x8B\x55\x64\x50\x6A\0\x51\x52\xE8\xE6\0\0\0\x88\x43\x17\x8B\x85\xC4\0\0\0\x8B\x0D\x94\xE1\x68\0\x8B\x95\x84\0\0\0\x50\x8B\x45\x64\x51\x52\x50\xE8\xC5\0\0\0\xA2\x98\xE1\x68\0\x83\xC4\x30\xC6\x43\x14\0\xC6\x43\x16\0", 106);

	/////////////////////////////	Stringhe modificate
	string mod_traod_p4_52("\xD9\x1D\x84\xCA\x71\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x37\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x22\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x88\xCA\x71\0\xFF\x77\x68\xE8\x0D\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x84\xCA\x71\0\xFF\x77\x6C\xE8\xF8\xFB\xFF\xFF\xA2\x80\xCA\x71\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p4_49("\xD9\x1D\x44\xBA\x71\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x37\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x22\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x48\xBA\x71\0\xFF\x77\x68\xE8\x0D\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x44\xBA\x71\0\xFF\x77\x6C\xE8\xF8\xFB\xFF\xFF\xA2\x40\xBA\x71\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p4_42("\xD9\x1D\x84\x37\x6F\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x37\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x22\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x88\x37\x6F\0\xFF\x77\x68\xE8\x0D\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x84\x37\x6F\0\xFF\x77\x6C\xE8\xF8\xFB\xFF\xFF\xA2\x80\x37\x6F\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p4_39("\xD9\x1D\x84\x97\x6E\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x37\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x22\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x88\x97\x6E\0\xFF\x77\x68\xE8\x0D\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x84\x97\x6E\0\xFF\x77\x6C\xE8\xF8\xFB\xFF\xFF\xA2\x80\x97\x6E\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p3_52("\xD9\x1D\x44\xBA\x70\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x41\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x2C\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x48\xBA\x70\0\xFF\x77\x68\xE8\x17\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x44\xBA\x70\0\xFF\x77\x6C\xE8\x02\xFC\xFF\xFF\xA2\x40\xBA\x70\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p3_49("\xD9\x1D\x04\xBA\x70\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x41\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x2C\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x08\xBA\x70\0\xFF\x77\x68\xE8\x17\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x04\xBA\x70\0\xFF\x77\x6C\xE8\x02\xFC\xFF\xFF\xA2\0\xBA\x70\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p3_42("\xD9\x1D\x44\x37\x6E\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x41\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x2C\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x48\x37\x6E\0\xFF\x77\x68\xE8\x17\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x44\x37\x6E\0\xFF\x77\x6C\xE8\x02\xFC\xFF\xFF\xA2\x40\x37\x6E\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_p3_39("\xD9\x1D\x04\x97\x6D\0\x6A\0\x6A\0\xFF\xB7\x80\0\0\0\xFF\x77\x60\xE8\x41\xFC\xFF\xFF\x88\x45\x15\x6A\0\x6A\0\xFF\xB7\x84\0\0\0\xFF\x77\x64\xE8\x2C\xFC\xFF\xFF\x88\x45\x17\x6A\0\x6A\0\xFF\x35\x08\x97\x6D\0\xFF\x77\x68\xE8\x17\xFC\xFF\xFF\x88\x45\x14\x6A\0\x6A\0\xFF\x35\x04\x97\x6D\0\xFF\x77\x6C\xE8\x02\xFC\xFF\xFF\xA2\0\x97\x6D\0\x88\x45\x16\x83\xC4\x40\x8B\x45\0\x90\x90\x90\x90", 105);
	string mod_traod_52("\x6A\0\x6A\0\xFF\xB5\x80\0\0\0\xFF\x75\x60\xE8\x0D\x01\0\0\x88\x43\x15\x6A\0\x6A\0\xFF\xB5\x84\0\0\0\xFF\x75\x64\xE8\xF8\0\0\0\x88\x43\x17\x6A\0\x6A\0\xFF\x35\x90\x22\x6C\0\xFF\x75\x68\xE8\xE3\0\0\0\x88\x43\x14\x6A\0\x6A\0\xFF\x35\x94\x22\x6C\0\xFF\x75\x6C\xE8\xCE\0\0\0\xA2\x98\x22\x6C\0\x88\x43\x16\x83\xC4\x40\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90", 106);
	string mod_traod_49("\x6A\0\x6A\0\xFF\xB5\x80\0\0\0\xFF\x75\x60\xE8\x0D\x01\0\0\x88\x43\x15\x6A\0\x6A\0\xFF\xB5\x84\0\0\0\xFF\x75\x64\xE8\xF8\0\0\0\x88\x43\x17\x6A\0\x6A\0\xFF\x35\xD0\x13\x6C\0\xFF\x75\x68\xE8\xE3\0\0\0\x88\x43\x14\x6A\0\x6A\0\xFF\x35\xD4\x13\x6C\0\xFF\x75\x6C\xE8\xCE\0\0\0\xA2\xD8\x13\x6C\0\x88\x43\x16\x83\xC4\x40\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90", 106);
	string mod_traod_42("\x6A\0\x6A\0\xFF\xB5\x80\0\0\0\xFF\x75\x60\xE8\x0D\x01\0\0\x88\x43\x15\x6A\0\x6A\0\xFF\xB5\x84\0\0\0\xFF\x75\x64\xE8\xF8\0\0\0\x88\x43\x17\x6A\0\x6A\0\xFF\x35\x60\x4A\x6A\0\xFF\x75\x68\xE8\xE3\0\0\0\x88\x43\x14\x6A\0\x6A\0\xFF\x35\x64\x4A\x6A\0\xFF\x75\x6C\xE8\xCE\0\0\0\xA2\x68\x4A\x6A\0\x88\x43\x16\x83\xC4\x40\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90", 106);
	string mod_traod_39("\x6A\0\x6A\0\xFF\xB5\x80\0\0\0\xFF\x75\x60\xE8\x0D\x01\0\0\x88\x43\x15\x6A\0\x6A\0\xFF\xB5\x84\0\0\0\xFF\x75\x64\xE8\xF8\0\0\0\x88\x43\x17\x6A\0\x6A\0\xFF\x35\x90\xE1\x68\0\xFF\x75\x68\xE8\xE3\0\0\0\x88\x43\x14\x6A\0\x6A\0\xFF\x35\x94\xE1\x68\0\xFF\x75\x6C\xE8\xCE\0\0\0\xA2\x98\xE1\x68\0\x88\x43\x16\x83\xC4\x40\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90", 106);

	size_t Position;
	bool GETPS2PAD_status = Detect_GETPS2PAD_status();
	if (GETPS2PAD_status)			// Se il file è modificato, bisogna cercare le stringhe mod e sostituirle con le originali
	{
		// TRAOD_P4
		if ((Position = EXEorig.find(mod_traod_p4_52)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p4_52, Position);
		if ((Position = EXEorig.find(mod_traod_p4_49)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p4_49, Position);
		if ((Position = EXEorig.find(mod_traod_p4_42)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p4_42, Position);
		if ((Position = EXEorig.find(mod_traod_p4_39)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p4_39, Position);

		// TRAOD_P3
		if ((Position = EXEorig.find(mod_traod_p3_52)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p3_52, Position);
		if ((Position = EXEorig.find(mod_traod_p3_49)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p3_49, Position);
		if ((Position = EXEorig.find(mod_traod_p3_42)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p3_42, Position);
		if ((Position = EXEorig.find(mod_traod_p3_39)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_p3_39, Position);

		// TRAOD
		if ((Position = EXEorig.find(mod_traod_52)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_52, Position);
		if ((Position = EXEorig.find(mod_traod_49)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_49, Position);
		if ((Position = EXEorig.find(mod_traod_42)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_42, Position);
		if ((Position = EXEorig.find(mod_traod_39)) != std::string::npos)
			ChangeSTRINGValue(orig_traod_39, Position);
	}
	else				// Altrimenti, se il file è originale si applicano le stringhe modificate
	{
		// TRAOD_P4
		if ((Position = EXEorig.find(orig_traod_p4_52)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p4_52, Position);
		if ((Position = EXEorig.find(orig_traod_p4_49)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p4_49, Position);
		if ((Position = EXEorig.find(orig_traod_p4_42)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p4_42, Position);
		if ((Position = EXEorig.find(orig_traod_p4_39)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p4_39, Position);

		// TRAOD_P3
		if ((Position = EXEorig.find(orig_traod_p3_52)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p3_52, Position);
		if ((Position = EXEorig.find(orig_traod_p3_49)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p3_49, Position);
		if ((Position = EXEorig.find(orig_traod_p3_42)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p3_42, Position);
		if ((Position = EXEorig.find(orig_traod_p3_39)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_p3_39, Position);

		// TRAOD
		if ((Position = EXEorig.find(orig_traod_52)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_52, Position);
		if ((Position = EXEorig.find(orig_traod_49)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_49, Position);
		if ((Position = EXEorig.find(orig_traod_42)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_42, Position);
		if ((Position = EXEorig.find(orig_traod_39)) != std::string::npos)
			ChangeSTRINGValue(mod_traod_39, Position);
	}
}